<div class="modal-overlay" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Análisis Detallado: {{ macroproceso.nombre }}</h2>
      <button class="close-button" (click)="closeModal()">×</button>
    </div>
    
    <div class="modal-body">
      <p class="objetivo">{{ macroproceso.objetivo }}</p>
      
      <div class="chart-grid">
        <div class="chart-container">
          <h3>1. Nivel de Existencia ({{ macroproceso.pctExistente }}%)</h3>
          <canvas baseChart
            [data]="existenciaData"
            [options]="chartOptions"
            [type]="doughnutChartType">
          </canvas>
        </div>

        <div class="chart-container">
          <h3>2. Nivel de Actualización ({{ macroproceso.pctActualizado }}%)</h3>
          <canvas baseChart
            [data]="actualizacionData"
            [options]="chartOptions"
            [type]="barChartType">
          </canvas>
        </div>

        <div class="chart-container">
          <h3>3. Nivel de Automatización ({{ macroproceso.pctAutomatizado }}%)</h3>
          <canvas baseChart
            [data]="automatizacionData"
            [options]="chartOptions"
            [type]="doughnutChartType">
          </canvas>
          <p class="fase3-note" *ngIf="macroproceso.semaforoAutomatizado === 'Rojo'">
            **ALTO POTENCIAL DE FASE 3:** La baja automatización indica una necesidad urgente del ERP GH.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>